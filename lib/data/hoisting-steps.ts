/**
 * Step-by-step data for Hoisting visualization
 */

import type { HoistingStep } from '@/lib/types';

export const hoistingCode = `console.log(name);    // What happens?
console.log(age);     // What happens?
greet();              // What happens?

var name = "Alice";
let age = 25;

function greet() {
  console.log("Hello!");
}`;

export const hoistingSteps: HoistingStep[] = [
  {
    id: 'step-1',
    title: 'The Code Before Execution',
    explanation: `Before JavaScript runs a single line of your code, it goes through a "Creation Phase" where it scans the entire code and sets up memory. This is where hoisting happens! Let's see what JavaScript does with var, let, const, and function declarations. Notice how the code has console.log statements BEFORE the variables and function are declared - this would seem like it should cause errors, but hoisting changes everything.`,
    highlightedLines: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    state: {
      phase: 'creation',
      creationMemory: [],
      executionMemory: [],
      currentLine: 0,
      executionLine: 0,
      output: [],
    },
    duration: 3500,
  },
  {
    id: 'step-2',
    title: 'Creation Phase: Function Declarations',
    explanation: `JavaScript first looks for function declarations. When it finds "function greet()", the ENTIRE function is hoisted to memory - not just the name, but the complete function definition. This means you can call greet() before its declaration in the code! Functions are "first-class citizens" in JavaScript and get special treatment during hoisting.`,
    highlightedLines: [8, 9, 10],
    state: {
      phase: 'creation',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
      ],
      executionMemory: [],
      currentLine: 0,
      executionLine: 0,
      output: [],
    },
    duration: 3500,
  },
  {
    id: 'step-3',
    title: 'Creation Phase: var Declarations',
    explanation: `Next, JavaScript finds "var name". Variables declared with var are hoisted, but ONLY the declaration - not the assignment! The variable "name" is set to undefined during the creation phase. This is why accessing a var before its assignment gives you undefined instead of an error. This behavior can lead to subtle bugs, which is why let and const were introduced.`,
    highlightedLines: [5],
    state: {
      phase: 'creation',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
      ],
      executionMemory: [],
      currentLine: 0,
      executionLine: 0,
      output: [],
    },
    duration: 3500,
  },
  {
    id: 'step-4',
    title: 'Creation Phase: let/const - Temporal Dead Zone',
    explanation: `Now JavaScript finds "let age". Variables declared with let (and const) ARE hoisted, but they enter the "Temporal Dead Zone" (TDZ). Unlike var, they are NOT initialized to undefined. Accessing them before their declaration line causes a ReferenceError! The TDZ exists from the start of the scope until the declaration is reached. This makes let/const safer and more predictable than var.`,
    highlightedLines: [6],
    state: {
      phase: 'creation',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [],
      currentLine: 0,
      executionLine: 0,
      output: [],
    },
    duration: 4000,
  },
  {
    id: 'step-5',
    title: 'Creation Phase Complete - Memory Ready',
    explanation: `The Creation Phase is complete! Memory is now set up with: 1) greet function fully available, 2) name initialized to undefined, 3) age in the Temporal Dead Zone. Now JavaScript enters the Execution Phase and runs your code line by line. Watch what happens when we try to access these variables before their actual declaration lines!`,
    highlightedLines: [],
    state: {
      phase: 'creation',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      currentLine: 0,
      executionLine: 0,
      output: [],
    },
    duration: 3500,
  },
  {
    id: 'step-6',
    title: 'Execution: console.log(name)',
    explanation: `Line 1 executes: console.log(name). JavaScript looks up "name" in memory and finds... undefined! Because var hoists with undefined, this doesn't crash - it just logs "undefined". This is a classic JavaScript gotcha. The code "works" but probably not as intended. You expected "Alice" but got undefined because the assignment hasn't happened yet.`,
    highlightedLines: [1],
    state: {
      phase: 'execution',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      currentLine: 1,
      executionLine: 1,
      output: ['undefined'],
    },
    duration: 3500,
  },
  {
    id: 'step-7',
    title: 'Execution: console.log(age) - TDZ Error!',
    explanation: `Line 2 tries to execute: console.log(age). JavaScript looks up "age" and finds it's in the Temporal Dead Zone! Unlike var, accessing a let/const variable before its declaration throws a ReferenceError: "Cannot access 'age' before initialization". This is the TDZ protecting you from using uninitialized variables - a much safer behavior than var's silent undefined!`,
    highlightedLines: [2],
    state: {
      phase: 'execution',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      currentLine: 2,
      executionLine: 2,
      output: ['undefined'],
      error: "ReferenceError: Cannot access 'age' before initialization",
    },
    duration: 4000,
  },
  {
    id: 'step-8',
    title: 'Execution: greet() - Works!',
    explanation: `Line 3 calls greet(). Even though the function is declared at line 8-10, it works perfectly! Function declarations are fully hoisted - the entire function body is available from the start of execution. "Hello!" is logged to the console. This is why you can organize your code with function calls at the top and definitions at the bottom.`,
    highlightedLines: [3],
    state: {
      phase: 'execution',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      currentLine: 3,
      executionLine: 3,
      output: ['undefined', 'Hello!'],
    },
    duration: 3500,
  },
  {
    id: 'step-9',
    title: 'Execution: var name = "Alice"',
    explanation: `Line 5 executes the assignment: name = "Alice". Now the "name" variable finally gets its actual value! The undefined placeholder is replaced with "Alice". This is when the ASSIGNMENT happens - the declaration was hoisted earlier, but the value assignment happens here, in order. If you logged name again now, you'd get "Alice".`,
    highlightedLines: [5],
    state: {
      phase: 'execution',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: '"Alice"',
          type: 'var',
          status: 'initialized',
          color: '#10B981',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      currentLine: 5,
      executionLine: 5,
      output: ['undefined', 'Hello!'],
    },
    duration: 3000,
  },
  {
    id: 'step-10',
    title: 'Execution: let age = 25 - TDZ Ends',
    explanation: `Line 6 executes: let age = 25. The Temporal Dead Zone for "age" finally ends! The variable leaves the TDZ and gets initialized with the value 25. From this point forward, "age" can be safely accessed. The TDZ lasted from the start of the scope until this exact line. This is the key difference between let/const and var - they require initialization before access.`,
    highlightedLines: [6],
    state: {
      phase: 'execution',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: '"Alice"',
          type: 'var',
          status: 'initialized',
          color: '#10B981',
        },
        {
          id: 'age',
          name: 'age',
          value: '25',
          type: 'let',
          status: 'initialized',
          color: '#10B981',
        },
      ],
      currentLine: 6,
      executionLine: 6,
      output: ['undefined', 'Hello!'],
    },
    duration: 3500,
  },
  {
    id: 'step-11',
    title: 'Hoisting Complete!',
    explanation: `The code has finished executing! Summary of hoisting behavior: 1) Function declarations are FULLY hoisted - usable anywhere, 2) var is hoisted with undefined - can access but get undefined before assignment, 3) let/const are hoisted but in TDZ - accessing before declaration throws an error. Best practice: Use const by default, let when needed, avoid var. Always declare variables at the top of their scope for clarity!`,
    highlightedLines: [],
    state: {
      phase: 'execution',
      creationMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: 'undefined',
          type: 'var',
          status: 'hoisted',
          color: '#F97316',
        },
        {
          id: 'age',
          name: 'age',
          value: '<TDZ>',
          type: 'let',
          status: 'tdz',
          color: '#EF4444',
        },
      ],
      executionMemory: [
        {
          id: 'greet',
          name: 'greet',
          value: 'ƒ greet() {...}',
          type: 'function',
          status: 'hoisted',
          color: '#10B981',
        },
        {
          id: 'name',
          name: 'name',
          value: '"Alice"',
          type: 'var',
          status: 'initialized',
          color: '#10B981',
        },
        {
          id: 'age',
          name: 'age',
          value: '25',
          type: 'let',
          status: 'initialized',
          color: '#10B981',
        },
      ],
      currentLine: 0,
      executionLine: 10,
      output: ['undefined', 'Hello!'],
    },
    duration: 4000,
  },
];

export const hoistingKeyTakeaways = [
  'Hoisting moves declarations to the top of their scope during the Creation Phase',
  'Function declarations are fully hoisted - the entire function is available immediately',
  'var declarations are hoisted and initialized to undefined',
  'let and const are hoisted but stay in the Temporal Dead Zone until their declaration',
  'Accessing a TDZ variable throws a ReferenceError - this prevents bugs!',
  'Best practice: use const by default, let when reassignment is needed, avoid var',
];
